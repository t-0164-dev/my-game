<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>100ます計算</title>
<style>
  body { font-family: sans-serif; text-align: center; }
  table { border-collapse: collapse; margin: 0 auto; }
  td, th { border: 1px solid #000; width: 50px; height: 50px; text-align: center; }
  input { width: 100%; height: 100%; text-align: center; font-size: 18px; }
  th { background-color: #f0f0f0; }
  button { font-size: 16px; margin-bottom: 10px; padding: 5px 10px; }
</style>
</head>
<body>

<h2>100ます計算</h2>
<button onclick="generateTable()">新しい問題</button>
<br><br>
<table id="masuTable"></table>

<script>
// 配列をシャッフルする関数
function shuffle(array) {
  for (let i = array.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [array[i], array[j]] = [array[j], array[i]];
  }
  return array;
}

// 100ますテーブルを生成
function generateTable() {
  const table = document.getElementById("masuTable");
  table.innerHTML = "";

  const numbers = [1,2,3,4,5,6,7,8,9,10];
  const rowLabels = shuffle([...numbers]);
  const colLabels = shuffle([...numbers]);

  // ヘッダ行
  const headerRow = document.createElement("tr");
  headerRow.appendChild(document.createElement("th")); // 左上空白
  for (let c = 0; c < 10; c++) {
    const th = document.createElement("th");
    th.textContent = colLabels[c];
    headerRow.appendChild(th);
  }
  table.appendChild(headerRow);

  // 各行
  for (let r = 0; r < 10; r++) {
    const tr = document.createElement("tr");
    const th = document.createElement("th");
    th.textContent = rowLabels[r];
    tr.appendChild(th);

    for (let c = 0; c < 10; c++) {
      const td = document.createElement("td");
      const input = document.createElement("input");
      input.type = "number";

      input.addEventListener("focus", () => {
        // 前回ハイライトをリセット
        const allHeaders = table.querySelectorAll("th");
        allHeaders.forEach(h => h.style.backgroundColor = "#f0f0f0");

        // 今のセルの縦横ヘッダを落ち着いた黄色でハイライト
        table.rows[r+1].cells[0].style.backgroundColor = "#ffeb99"; // 左の行ラベル
        table.rows[0].cells[c+1].style.backgroundColor = "#ffeb99"; // 上の列ラベル
      });

      input.addEventListener("input", () => {
        if (parseInt(input.value) === rowLabels[r]*colLabels[c]) {
          input.style.backgroundColor = "green";

          // 正解したら次のセルに移動
          let nextRow = r;
          let nextCol = c + 1;
          if (nextCol >= 10) { // 右端なら次の行
            nextCol = 0;
            nextRow++;
            if (nextRow >= 10) return; // 最後のセルなら移動しない
          }
          const nextInput = table.rows[nextRow+1].cells[nextCol+1].firstChild; 
          nextInput.focus();
        } else {
          input.style.backgroundColor = "";
        }
      });

      td.appendChild(input);
      tr.appendChild(td);
    }

    table.appendChild(tr);
  }
}
</script>

</body>
</html>
